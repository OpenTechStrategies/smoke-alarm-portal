extends layout

block content
  #container.container-fluid
    #main.row
      #left.col-sm-12
         p.bigger
           | Thank you for your interest in having one or more 10-year lithium-ion battery powered smoke alarms installed in your home.
         p
           | Please complete all fields in the form below and click “submit”. An American Red Cross representative will contact you shortly to confirm your registration into our wait list. Additional information on installation will be given at that time.
      // I added this to center the fields, but I think it's probably incorrect                    
      .col-sm-3
      #center.col-sm-6
        .container-fluid
          form(action="/", method="POST", class="form-horizontal")
            fieldset
              .row
                // Text input
                .form-group
                  .col-xs-12
                    .row
                      .col-xs-11
                        input#name.form-control.input-md(name='name', type='text', placeholder='Your Name', required)
                      .col-xs-1.warning-star
              .row
                  // Text input
                  .form-group
                    .col-xs-11
                      input#street_address.form-control.input-md(name='street_address', type='text', placeholder='Address & Unit')
              .row
                  // Text input
                  .form-group
                    .col-xs-6
                      input#city.form-control.input-md(name='city', type='text', placeholder='City')
                    .col-xs-5
                      select#state.form-control(name='state')
                        option(value='' disabled selected) State
                        option(value='Alabama') Alabama
                        option(value='Alaska') Alaska
                        option(value='Arizona') Arizona
                        option(value='Arkansas') Arkansas
                        option(value='California') California
                        option(value='Colorado') Colorado
                        option(value='Connecticut') Connecticut
                        option(value='Delaware') Delaware
                        option(value='District of Columbia') District of Columbia
                        option(value='Florida') Florida
                        option(value='Georgia') Georgia
                        option(value='Hawaii') Hawaii
                        option(value='Idaho') Idaho
                        option(value='Illinois') Illinois
                        option(value='Indiana') Indiana
                        option(value='Iowa') Iowa
                        option(value='Kansas') Kansas
                        option(value='Kentucky') Kentucky
                        option(value='Louisiana') Louisiana
                        option(value='Maine') Maine
                        option(value='Maryland') Maryland
                        option(value='Massachusetts') Massachusetts
                        option(value='Michigan') Michigan
                        option(value='Minnesota') Minnesota
                        option(value='Mississippi') Mississippi
                        option(value='Missouri') Missouri
                        option(value='Montana') Montana
                        option(value='Nebraska') Nebraska
                        option(value='Nevada') Nevada
                        option(value='New Hampshire') New Hampshire
                        option(value='New Jersey') New Jersey
                        option(value='New Mexico') New Mexico
                        option(value='New York') New York
                        option(value='North Carolina') North Carolina
                        option(value='North Dakota') North Dakota
                        option(value='Ohio') Ohio
                        option(value='Oklahoma') Oklahoma
                        option(value='Oregon') Oregon
                        option(value='Pennsylvania') Pennsylvania
                        option(value='Rhode Island') Rhode Island
                        option(value='South Carolina') South Carolina
                        option(value='South Dakota') South Dakota
                        option(value='Tennessee') Tennessee
                        option(value='Texas') Texas
                        option(value='Utah') Utah
                        option(value='Vermont') Vermont
                        option(value='Virginia') Virginia
                        option(value='Washington') Washington
                        option(value='West Virginia') West Virginia
                        option(value='Wisconsin') Wisconsin
                        option(value='Wyoming') Wyoming
              .row
                  // Text input
                  .form-group
                    .col-xs-12
                      .row
                        .col-xs-4
                          input#zip.form-control.input-md(name='zip', type='text', placeholder='Zip Code', class='required zipcodeUS valid')
                        .col-xs-1.warning-star
              .row
                  .form-group
                    .col-xs-12
                      .row
                        .col-xs-5
                          input#phone.form-control.input-md(name='phone', type='text', placeholder='Phone #', class='contact-group phoneUS valid')
                        .col-xs-1.warning-star
              .row
                  .form-group
                    .col-xs-12
                      .row
                        .col-xs-8
                          input#email.form-control.input-md(name='email', type='text', placeholder='Email', class='contact-group email valid')
                        .col-xs-1.warning-star
              .row
                  // http://www.sitepoint.com/understanding-bootstrap-grid-system/ helped
                  .form-group
                    .col-xs-6
                      button#singlebutton.btn.btn-primary(name='singlebutton') Submit
      #right.col-sm-12
         p
           | The American Red Cross and its partners have launched an initiative that aims to reduce deaths and injuries caused by home fires by 25% in five years with the Home Fire Preparedness Campaign.  The Red Cross is asking every household in America to join us in taking two simple steps that can save lives: checking or installing smoke alarms and practicing fire drills at home. 
         p
           | Currently available in: IA, ID, IL, KS, MN, MO, MT, ND, NE, SD, WI.
          .row
              .col-xs-2
      .col-sm-4
      .col-sm-4
         img.logo(src='./smokeAlarmPortal_files/redcross-logo-white-letters.png', alt='American Red Cross')

    script(type="text/javascript").
      $("select").addClass('state-not-yet-selected');
      $("select").bind("focus", function () {
        $(this).children('option[value="state-not-yet-selected"]').remove();
        $(this).removeClass('state-not-yet-selected');
      });           
      $(".form-horizontal").validate({
        rules: {
          phone: {
            require_from_group: [1, ".contact-group"]
          },
          email: {
            require_from_group: [1, ".contact-group"]
          },
        }, 
        showErrors: function(errorMap, errorList) {
          for (var i=0; i<errorList.length; i++) {
            var element = errorList[i]["element"];
            var message = errorList[i]["message"];
            var warningBox = $(element).parent().next(".warning-star");
            $(element).addClass("redstripe");
            warningBox.removeClass("warning-star");
            warningBox.addClass("warning-text");
            // Right now, this message is squeezed into one word per
            // line, because of how we've moved the input fields into
            // the middle column.  However, we should probably tackle
            // that problem after deciding whether we're combining
            // email and phone number into one field, as per issue
            // #36#issuecomment-119059556, because if we're combining
            // them then we'll be writing a custom validation wrapper
            // anyway and can solve the positioning problem in that.
            warningBox.text(message);
          }
        }
      });
